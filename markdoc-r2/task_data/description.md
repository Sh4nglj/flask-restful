# 任务 Prompt

修复 Flask-RESTful fields 模块在序列化包含循环引用的数据结构时的内存泄漏和栈溢出问题，具体需求如下：
1. 修复 marshal 函数在处理循环引用对象时进入无限递归，导致栈溢出的问题
2. 实现循环引用检测机制，使用弱引用或访问记录来跟踪已处理的对象
3. 修复 Nested 字段在处理自引用对象时的递归问题
4. 修复 List 字段在处理包含循环引用的列表时的序列化错误
5. 当检测到循环引用时，提供配置选项：抛出异常、返回占位符或跳过该字段
6. 修复循环引用导致的内存泄漏，确保临时对象能够被正确垃圾回收
7. 优化序列化性能，避免重复处理相同的对象引用
8. 添加深度限制选项，防止过深的嵌套结构导致栈溢出
9. 实现循环引用的可视化输出（如 {'$ref': '#/path/to/object'}），符合 JSON Reference 规范
10. 编写测试用例，覆盖各种循环引用场景（自引用、相互引用、深层循环）

## 题目方向
运行时异常修复

## 代码量估算
Hard: ≥300行多文件

## 技术栈广度
Hard: 跨技术栈≥3种（Python、内存管理、算法、JSON 规范）

## 优化要求
Hard: 极致性能/资源优化（内存使用、递归优化）

## 人工开发耗时预估
Hard: ≥4小时
